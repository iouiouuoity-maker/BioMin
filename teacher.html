<!doctype html>
<html lang="kk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BioMind 5–11 • Мұғалім</title>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
<header class="nav">
  <div class="nav-inner">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <h1>BioMind 5–11</h1>
        <small>Мұғалім панелі (жеңіл нұсқа)</small>
      </div>
    </div>
    <nav class="menu">
      <a class="pill" href="index.html">Басты бет</a>
      <a class="pill" href="grades.html">Сыныптар</a>
      <a class="pill" href="library.html">Кітапхана</a>
      <a class="pill" href="teacher.html">Мұғалім</a>
    </nav>
  </div>
</header>

<main class="container">
  <div class="card">
    <h2 class="h-title" style="margin:0 0 10px 0">Мұғалім панелі</h2>
    <p class="h-sub">
      Бұл бетте оқушының қысқа нәтижесін жинай аласыз. Төменге енгізіп, <span class="kbd">Сақтау</span> басыңыз.
      (Дерек осы браузерде сақталады.)
    </p>
  </div>

  <div class="grid" style="grid-template-columns:1fr 1fr">
    <div class="card">
      <h3 class="section-title" style="margin-top:0">Нәтиже қосу</h3>
      <label>Оқушы аты-жөні</label><br/>
      <input id="sName" class="pill" style="width:100%; margin-top:6px" placeholder="Аты-жөні" /><br/><br/>

      <label>Сынып</label><br/>
      <input id="sGrade" class="pill" style="width:100%; margin-top:6px" placeholder="5А / 8Б / 10..." /><br/><br/>

      <label>Тақырып</label><br/>
      <input id="sTopic" class="pill" style="width:100%; margin-top:6px" placeholder="Фотосинтез / Генетика..." /><br/><br/>

      <label>Қысқа қорытынды / рефлексия</label><br/>
      <textarea id="sNote" style="width:100%; min-height:120px; padding:12px; border-radius:14px; border:1px solid var(--border)"></textarea>

      <div class="btn-row">
        <button class="btn primary" id="saveBtn" type="button">Сақтау</button>
        <button class="btn" id="clearBtn" type="button">Тазалау</button>
      </div>
      <p class="embed-note">Кеңес: әр сабақтан кейін 2–3 сөйлем рефлексия жазғызсаңыз, қорғауда “нәтиже” дәлел болады.</p>
    </div>

    <div class="card">
      <h3 class="section-title" style="margin-top:0">Сақталған жазбалар</h3>
      <table class="table" id="tbl">
        <thead>
          <tr><th>Оқушы</th><th>Сынып</th><th>Тақырып</th><th>Ескертпе</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="btn-row" style="margin-top:12px">
        <button class="btn" id="exportBtn" type="button">Экспорт (TXT)</button>
        <button class="btn" id="wipeBtn" type="button">Барлығын өшіру</button>
      </div>
    </div>
  </div>

  <p class="footer">Кейін қаласаңыз: Google Sheet/Forms-қа автомат жинауды қосып берем.</p>
</main>

<script>
  const KEY = "biomind_records_v1";
  const $ = (id)=>document.getElementById(id);
  const tbody = document.querySelector("#tbl tbody");

  function load(){
    const data = JSON.parse(localStorage.getItem(KEY) || "[]");
    tbody.innerHTML = "";
    data.forEach(r=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${escapeHtml(r.name)}</td><td>${escapeHtml(r.grade)}</td><td>${escapeHtml(r.topic)}</td><td>${escapeHtml(r.note)}</td>`;
      tbody.appendChild(tr);
    });
    return data;
  }

  function saveRecord(){
    const rec = {
      name: $("sName").value.trim(),
      grade: $("sGrade").value.trim(),
      topic: $("sTopic").value.trim(),
      note: $("sNote").value.trim()
    };
    if(!rec.name || !rec.grade || !rec.topic) return alert("Аты-жөні, сынып, тақырып міндетті.");

    const data = load();
    data.unshift(rec);
    localStorage.setItem(KEY, JSON.stringify(data));
    $("sName").value = $("sGrade").value = $("sTopic").value = $("sNote").value = "";
    load();
  }

  function exportTxt(){
    const data = load();
    const text = data.map((r,i)=>`${i+1}) ${r.name} | ${r.grade} | ${r.topic}\n   ${r.note}\n`).join("\n");
    const blob = new Blob([text], {type:"text/plain;charset=utf-8"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "biomind_records.txt";
    a.click();
    URL.revokeObjectURL(a.href);
  }

  function escapeHtml(s){
    return (s||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;");
  }

  $("saveBtn").addEventListener("click", saveRecord);
  $("clearBtn").addEventListener("click", ()=>{$("sName").value="";$("sGrade").value="";$("sTopic").value="";$("sNote").value="";});
  $("exportBtn").addEventListener("click", exportTxt);
  $("wipeBtn").addEventListener("click", ()=>{
    if(confirm("Шынымен бәрін өшіресіз бе?")){
      localStorage.removeItem(KEY); load();
    }
  });

  load();
</script>
</body>
</html>
